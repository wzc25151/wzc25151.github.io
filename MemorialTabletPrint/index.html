<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">

    <title>免费简易牌位打印</title>
    <link type="text/css" rel="styleSheet" href="base.css" />
    <link type="text/css" rel="styleSheet" href="index.css" />
</head>

<body>
    <div id="container">
        <div id="contentPanel">

            <div id="ysrPanel">
                <div id="ysrTopPart"> 陽上</div>
                <div id="ysrName">阳上人名字</div>
                <div id="ysrBottomPart">敬薦</div>
            </div>

            <div id="namePanel">
                <div id="namePart">
                    <div id="nameColumn1" class="nameColumn">列1</div>
                    <div id="nameColumn2" class="nameColumn">列2</div>
                    <div id="nameColumn3" class="nameColumn">列3</div>
                    <div id="nameColumn4" class="nameColumn">列4</div>
                    <div id="nameColumn5" class="nameColumn">列5</div>
                </div>
                <div id="nameColumnBottomPart">合家</div>
            </div>

            <div id="addrPanel">
                <div id="addr">地址</div>
            </div>
        </div>


        <!--控制台-->
        <div class="no-print" id="consolePanel">
            控制台

            <div class="option">
                牌位纸规格
                <span class="selected">12.5*36cm</span>

            </div>

            <div id="bgImgOption" class="option">
                参照背景
                <span id="bgImg0" class="unSelected" onclick="switchBgImg(0)">无</span>
                <span id="bgImg1" class="selected" onclick="switchBgImg(1)">超度1</span>
                <span id="bgImg2" class="unSelected" onclick="switchBgImg(2)">超度2</span>

            </div>

            <div class="option">
                <div>
                    阳上前缀
                    <input id="ysrTopInput" type="text" oninput="ysrTopOnInput()" size="10" value="陽上" />
                    字号
                    <input id="ysrTopSizeInput" type="text" oninput="ysrTopSizeOnInput()" size="2" value="38" />
                    加粗
                    <input type="checkbox" checked="true" onclick="fontBoldCheckbox('ysrTopPart')" />
                </div>
                <div>
                    阳上人名
                    <input id="ysrNameInput" type="text" oninput="ysrNameOnInput()" size="10" value="名字" />
                    字号
                    <input id="ysrSizeInput" type="text" oninput="ysrSizeOnInput()" size="2" value="32" />
                    加粗
                    <input type="checkbox" onclick="fontBoldCheckbox('ysrName')" />
                </div>
                <div>
                    阳上后缀
                    <input id="ysrBottomInput" type="text" oninput="ysrBottomOnInput()" size="10" value="敬薦" />
                    字号
                    <input id="ysrBottomSizeInput" type="text" oninput="ysrBottomSizeOnInput()" size="2" value="38" />
                    加粗
                    <input type="checkbox" checked="true" onclick="fontBoldCheckbox('ysrBottomPart')" />
                </div>
            </div>

            <div id="nameColumnOption" class="option">
                <div>
                    牌主名1
                    <input id="nameColumnInput1" type="text" oninput="nameColumnOnInput(1)" size="11" value="列1" />
                    字号
                    <input id="nameColumnSizeInput1" type="text" oninput="nameColumnSizeOnInput(1)" size="2"
                        value="36" />
                    加粗
                    <input type="checkbox" onclick="fontBoldCheckbox('nameColumn1')" />
                </div>
                <div>
                    牌主名2
                    <input id="nameColumnInput2" type="text" oninput="nameColumnOnInput(2)" size="11" value="列2" />
                    字号
                    <input id="nameColumnSizeInput2" type="text" oninput="nameColumnSizeOnInput(2)" size="2"
                        value="36" />
                    加粗
                    <input type="checkbox" onclick="fontBoldCheckbox('nameColumn2')" />
                </div>
                <div>
                    牌主名3
                    <input id="nameColumnInput3" type="text" oninput="nameColumnOnInput(3)" size="11" value="列3" />
                    字号
                    <input id="nameColumnSizeInput3" type="text" oninput="nameColumnSizeOnInput(3)" size="2"
                        value="36" />
                    加粗
                    <input type="checkbox" onclick="fontBoldCheckbox('nameColumn3')" />
                </div>
                <div>
                    牌主名4
                    <input id="nameColumnInput4" type="text" oninput="nameColumnOnInput(4)" size="11" value="列4" />
                    字号
                    <input id="nameColumnSizeInput4" type="text" oninput="nameColumnSizeOnInput(4)" size="2"
                        value="36" />
                    加粗
                    <input type="checkbox" onclick="fontBoldCheckbox('nameColumn4')" />
                </div>
                <div>
                    牌主名5
                    <input id="nameColumnInput5" type="text" oninput="nameColumnOnInput(5)" size="11" value="列5" />
                    字号
                    <input id="nameColumnSizeInput5" type="text" oninput="nameColumnSizeOnInput(5)" size="2"
                        value="36" />
                    加粗
                    <input type="checkbox" onclick="fontBoldCheckbox('nameColumn5')" />
                </div>
            </div>
            <div>
                牌主后缀
                <input id="nameColumnBottomInput" type="text" oninput="nameColumnBottomOnInput()" size="10"
                    value="合家" />
                字号
                <input id="nameColumnBottomSizeInput" type="text" oninput="nameColumnBottomSizeOnInput()" size="2"
                    value="46" />
                加粗
                <input type="checkbox" checked="true" onclick="fontBoldCheckbox('nameColumnBottomPart')" />
            </div>

            <div class="option">
                地址
                <input id="addrInput" type="text" oninput="addrOnInput()" size="16" value="地址" />
                字号
                <input id="addrSizeInput" type="text" oninput="addrSizeOnInput()" size="2" value="32" />
                加粗
                <input type="checkbox" onclick="fontBoldCheckbox('addr')" />
            </div>

            <div class="option">
                <button onclick="window.print()">打印</button>
                <button onclick="clearNameAddr()">清空名字和地址</button>
                <button onclick="clearAllText()">清空所有文字</button>
            </div>

            <div id="illustrate" class="option">
                一些说明：<br />
                1.打印时检查打印预览的参数，注意预览中是否有留白；<br />
                2.打印时不要勾选背景、页眉和页脚，页边距为0;<br />
                3.调整好打印机卡槽对应纸张规格和纸张方向。

                <br />
                <br />
                下载word模板：<br />
                <a href="../MemorialTabletPrint/other/超度牌位模板1(12.5x36cm).docx"> 超度牌位模板1(12.5x36cm).docx</a>，
                <br />
                <a href="../MemorialTabletPrint/other/超度牌位模板1(12.5x36cm)-带背景图.docx">超度牌位模板1(12.5x36cm)-带背景图.docx</a>
                <br />
                <br />
                联系微信wzc25151
            </div>
        </div>
    </div>

</body>

<script>

    //A4纸的尺寸是210mm*297mm，也就是21.0cm*29.7cm，而1英寸=2.54cm，如果屏幕DPI分辨率为72像素/英寸，换算一下：相当于1cm可呈现 (72px/2.54cm) = 28.34px
    //一般72dpi下1cm=28.34px，96dpi下1cm=37.79px
    //12.5*36cm，网页是96dpi，354*2012,缩放1.3倍是460*1326，472.375*1360.44



    //切换背景
    function switchBgImg(num) {
        var bgImgList = document.getElementById("bgImgOption").getElementsByTagName("span");
        for (var i = 0; i < bgImgList.length; i++) {
            bgImgList[i].className = "unSelected";
        }
        document.getElementById("bgImg" + num).className = "selected";

        switch (num) {
            case 0:
                document.getElementById("contentPanel").style.backgroundImage = "url()";
                break;
            case 1:
                document.getElementById("contentPanel").style.backgroundImage = "url(../MemorialTabletPrint/images/chaodu1.png)";
                break;
            case 2:
                document.getElementById("contentPanel").style.backgroundImage = "url(../MemorialTabletPrint/images/chaodu2.png)";
                break;
            default:
                break;
        }

    }

    //文本加粗
    function fontBoldCheckbox(idName) {
        if (window.event.srcElement.checked) {
            document.getElementById(idName).style.fontWeight = "bold";
        } else {
            document.getElementById(idName).style.fontWeight = "normal";
        }
    }


    //阳上人前缀文本监听
    function ysrTopOnInput() {
        document.getElementById("ysrTopPart").innerText = document.getElementById("ysrTopInput").value;
    }

    //阳上人前缀文本的字体大小
    function ysrTopSizeOnInput() {
        var size = document.getElementById("ysrTopSizeInput").value;
        document.getElementById("ysrTopPart").style.fontSize = size + "px";
    }

    //阳上人文本监听
    function ysrNameOnInput() {
        document.getElementById("ysrName").innerText = document.getElementById("ysrNameInput").value;
    }

    //阳上人文本的字体大小
    function ysrSizeOnInput() {
        var size = document.getElementById("ysrSizeInput").value;
        document.getElementById("ysrName").style.fontSize = size + "px";
    }

    //阳上人后缀文本监听
    function ysrBottomOnInput() {
        document.getElementById("ysrBottomPart").innerText = document.getElementById("ysrBottomInput").value;
    }

    //阳上人后缀文本的字体大小
    function ysrBottomSizeOnInput() {
        var size = document.getElementById("ysrBottomSizeInput").value;
        document.getElementById("ysrBottomPart").style.fontSize = size + "px";
    }



    //中间人牌主文本监听
    function nameColumnOnInput(num) {
        document.getElementById("nameColumn" + num).innerText = document.getElementById("nameColumnInput" + num).value;

    }
    //中间人牌主文本的字体大小
    function nameColumnSizeOnInput(num) {
        var textFontSize = document.getElementById("nameColumnSizeInput" + num).value;
        document.getElementById("nameColumn" + num).style.fontSize = textFontSize + "px";
    }



    //合家文本监听
    function nameColumnBottomOnInput() {
        document.getElementById("nameColumnBottomPart").innerText = document.getElementById("nameColumnBottomInput").value;

        //排版上如果合家为空，那么需要增加牌主内容的长度
        if ("" == document.getElementById("nameColumnBottomInput").value) {
            document.getElementById("namePart").style.height = 400 + "px";
        } else {
            document.getElementById("namePart").style.height = 300 + "px";
        }
    }
    //合家文本的字体大小
    function nameColumnBottomSizeOnInput() {
        var textFontSize = document.getElementById("nameColumnBottomSizeInput").value;
        document.getElementById("nameColumnBottomPart").style.fontSize = textFontSize + "px";
    }

    //地址文本监听
    function addrOnInput() {
        var textStr = document.getElementById("addrInput").value;
        document.getElementById("addr").innerText = textStr;
    }
    //地址文本的字体大小
    function addrSizeOnInput() {
        var textFontSize = document.getElementById("addrSizeInput").value;
        document.getElementById("addr").style.fontSize = textFontSize + "px";
    }

    //清空名字和地址
    function clearNameAddr() {
        document.getElementById("ysrNameInput").value = '';
        ysrNameOnInput();

        var nameColumnList = document.getElementById("nameColumnOption").getElementsByTagName("div");
        for (var i = 0; i < nameColumnList.length; i++) {
            var input = nameColumnList[i].getElementsByTagName("Input");
            input[0].value = "";
            nameColumnOnInput(i + 1);
        }

        document.getElementById("addrInput").value = '';
        addrOnInput();

    }

    //清空所有文字
    function clearAllText() {
        clearNameAddr();
        document.getElementById("ysrTopInput").value = '';
        ysrTopOnInput();
        document.getElementById("ysrBottomInput").value = '';
        ysrBottomOnInput();

        document.getElementById("nameColumnBottomInput").value = '';
        nameColumnBottomOnInput();

    }


</script>

</html>